<% title t(:agroecological_practices) %>

<br><br><br>

<ul class="nav nav-tabs">
  <% if params[:local_id] %>
    <li class="nav-item">
      <%= link_to @local.nome.truncate(10), local_path(@local), title: @local.nome, :class => "nav-link" %>
    </li>
  <% end %>
  <li class="nav-item">
    <%= link_to t(:practices) + " (#{@agroecological_practices.count})", "#", :class => "nav-link active" %>
  </li>
</ul>

<% if @agroecological_practices.empty? %>
  <br>
  <h2><%= t(:no_data_has_been_registered_so_far) %></h2>
<% else %>
  <br>
  <div class="row">
    <% @agroecological_practices.each do |agroecological_practice| %>
      <div class="col-sm-6" style="cursor: pointer;" onclick="window.location='<%= agroecological_practice_path(agroecological_practice) %>';">
        <div class="card" style="min-height: 380px;">
          <br>
          <% if  agroecological_practice.midias and agroecological_practice.midias[0]%>
            <div class="card-img-top thumbnail-mini"><%= link_to image_tag(agroecological_practice.midias[0].imagem.url(:medium)), agroecological_practice_path(agroecological_practice), alt: agroecological_practice.local.nome, title: agroecological_practice.local.nome %></div>
          <% else %>
            <div class="card-img-top thumbnail-mini"><%= link_to image_tag(agroecological_practice.local.imagem.url(:medium)), agroecological_practice_path(agroecological_practice), alt: agroecological_practice.local.nome, title: agroecological_practice.local.nome %></div>
          <% end %>
          <div class="card-body">
            <%= "<b>Summary</b>".html_safe if agroecological_practice.summary_description and agroecological_practice.summary_description.length > 0 %>
            <p class="card-text text-box"><%= agroecological_practice.summary_description.truncate(160) %></p>
            <b>Location</b>
            <p class="card-text text-box"><%= link_to agroecological_practice.local.nome.truncate(160), local_path(agroecological_practice.local) %></p>
            <% if usuario_signed_in? %>
              <% if current_usuario.admin? or agroecological_practice.usuario.id == current_usuario.id %>
                <td><%= link_to t(:edit), edit_agroecological_practice_path(agroecological_practice), :class => 'btn btn-sm btn-success' %></td>
                <td><%= link_to t(:destroy), agroecological_practice_path(agroecological_practice), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'VocÃª tem Certeza?')) }, :class => 'btn btn-sm btn-danger' %></td>
              <% end %>
            <% end %>
          </div>
        </div><br>
      </div>
    <% end %>
  </div>

  <% if not params[:usuario_id] and not params[:local_id] %>
    <div>
      <%= paginate @agroecological_practices %>
    </div>
  <% end %>
<% end %>
